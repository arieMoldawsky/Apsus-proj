import { mailService } from '../services/mail-service.js';

export default {
    props: ['mail', 'isInbox'],
    template: `
    <section class="mail-preview-section" :class="unread">
        <div v-show="!mail.isRead" class="avatar-container">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:v="https://vecta.io/nano" shape-rendering="geometricPrecision" image-rendering="optimizeQuality" viewBox="7.086 7.087 1277.149 924.008"><path d="M1179.44 7.087c57.543 0 104.627 47.083 104.627 104.626v30.33l-145.36 103.833L643.833 586.77 148.96 242.42v688.676h-37.247c-57.543 0-104.627-47.082-104.627-104.625V111.742C7.086 54.198 54.17 7.115 111.713 7.115l532.12 394.525L1179.44 7.087z" fill="#e75a4d"/><linearGradient id="A" gradientUnits="userSpaceOnUse" x1="303.82" y1="204.384" x2="986.034" y2="204.384"><stop offset="0" stop-color="#f8f6ef"/><stop offset="1" stop-color="#e7e4d6"/></linearGradient><use xlink:href="#C" fill="url(#A)"/><path fill="#e7e4d7" d="M148.96 242.42v688.676h989.774V245.877l-494.9 340.894z"/><path fill="#b8b7ae" d="M148.96 931.095l494.873-344.324-2.24-1.586L148.96 923.527z"/><path fill="#b7b6ad" d="M1138.734 245.877l.283 685.218L643.833 586.77z"/><path d="M1284.066 142.044l.17 684.5c-2.494 76.082-35.46 103.238-145.22 104.514l-.283-685.22 145.332-103.805z" fill="#b2392f"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="url(#A)"/><use xlink:href="#C" fill="#f7f5ed"/><defs><path id="C" d="M111.713 7.087l532.12 394.525L1179.44 7.087z"/></defs></svg>
        </div>
        <div v-show="mail.isRead" class="avatar-container">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 512 512"><path d="M512 177.568V224L256 336 0 224v-46.432c0-10.944 5.6-21.12 14.816-27.008L247.52 2.432c5.184-3.232 11.776-3.232 16.96 0L497.184 150.56C506.4 156.448 512 166.624 512 177.568z" fill="#f44336"/><path d="M416 0H96C78.368 0 64 14.368 64 32v352a16.01 16.01 0 0 0 16 16h352a16.01 16.01 0 0 0 16-16V32c0-17.632-14.336-32-32-32z" fill="#eceff1"/><path d="M144 96h224a16.01 16.01 0 0 0 16-16 16.01 16.01 0 0 0-16-16H144a16.01 16.01 0 0 0-16 16 16.01 16.01 0 0 0 16 16zm224 32H144a16.01 16.01 0 0 0-16 16 16.01 16.01 0 0 0 16 16h224a16.01 16.01 0 0 0 16-16 16.01 16.01 0 0 0-16-16zm-96 64H144a16.01 16.01 0 0 0-16 16 16.01 16.01 0 0 0 16 16h128a16.01 16.01 0 0 0 16-16 16.01 16.01 0 0 0-16-16z" fill="#90a4ae"/><path d="M512,224v256c0,17.6-14.4,32-32,32H32c-17.6,0-32-14.4-32-32V224l256,112L512,224z" fill="#d32f2f"/></svg>
        </div>
        <div class="preview-sender" v-show="isInbox" >{{mail.sender}}</div>
        <div class="preview-sender" v-show="!isInbox" >{{mail.to}}</div>
        <div class="preview-subject">{{mail.subject}}</div>
        <div class="preview-mail-body">{{shortBody}}</div>
        <div class="preview-sent-at">{{convertSentTime}}</div>
        <!-- <button v-show="isInbox" @click.stop="onDeleteMail">Delete -->
        <div class="preview-delete-btn">
            <svg @click.stop="onStarClick" :class="isStarred" xmlns="http://www.w3.org/2000/svg" height="511pt" viewBox="0 -10 511.98685 511" width="511pt"><path d="m114.59375 491.140625c-5.609375 0-11.179688-1.75-15.933594-5.1875-8.855468-6.417969-12.992187-17.449219-10.582031-28.09375l32.9375-145.089844-111.703125-97.960937c-8.210938-7.167969-11.347656-18.519532-7.976562-28.90625 3.371093-10.367188 12.542968-17.707032 23.402343-18.710938l147.796875-13.417968 58.433594-136.746094c4.308594-10.046875 14.121094-16.535156 25.023438-16.535156 10.902343 0 20.714843 6.488281 25.023437 16.511718l58.433594 136.769532 147.773437 13.417968c10.882813.980469 20.054688 8.34375 23.425782 18.710938 3.371093 10.367187.253906 21.738281-7.957032 28.90625l-111.703125 97.941406 32.9375 145.085938c2.414063 10.667968-1.726562 21.699218-10.578125 28.097656-8.832031 6.398437-20.609375 6.890625-29.910156 1.300781l-127.445312-76.160156-127.445313 76.203125c-4.308594 2.558594-9.109375 3.863281-13.953125 3.863281zm141.398438-112.875c4.84375 0 9.640624 1.300781 13.953124 3.859375l120.277344 71.9375-31.085937-136.941406c-2.21875-9.746094 1.089843-19.921875 8.621093-26.515625l105.472657-92.5-139.542969-12.671875c-10.046875-.917969-18.6875-7.234375-22.613281-16.492188l-55.082031-129.046875-55.148438 129.066407c-3.882812 9.195312-12.523438 15.511718-22.546875 16.429687l-139.5625 12.671875 105.46875 92.5c7.554687 6.613281 10.859375 16.769531 8.621094 26.539062l-31.0625 136.9375 120.277343-71.914062c4.308594-2.558594 9.109376-3.859375 13.953126-3.859375zm-84.585938-221.847656s0 .023437-.023438.042969zm169.128906-.0625.023438.042969c0-.023438 0-.023438-.023438-.042969zm0 0"/></svg>
            <svg v-show="isInbox" @click.stop="onDeleteMail" enable-background="new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m490.667 85.333h-42.667-68.693l-7.019-28.075c-8.405-33.706-38.571-57.258-73.323-57.258h-85.931c-34.752 0-64.917 23.552-73.323 57.259l-7.019 28.075h-68.692-42.667c-11.797-.001-21.333 9.557-21.333 21.333s9.536 21.333 21.333 21.333h22.485l17.963 323.541c1.899 33.899 29.995 60.459 63.936 60.459h260.565c33.941 0 62.037-26.56 63.936-60.459l17.963-323.541h22.485c11.797 0 21.333-9.557 21.333-21.333s-9.535-21.334-21.332-21.334zm-309.59-17.728c3.691-14.677 16.811-24.939 31.957-24.939h85.931c15.147 0 28.267 10.261 31.957 24.939l4.416 17.728h-158.677zm10.923 337.728c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333zm85.333 0c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333zm85.334 0c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333z"/></svg>
            <svg v-show="!isInbox" @click.stop="onDeleteSent" enable-background="new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m490.667 85.333h-42.667-68.693l-7.019-28.075c-8.405-33.706-38.571-57.258-73.323-57.258h-85.931c-34.752 0-64.917 23.552-73.323 57.259l-7.019 28.075h-68.692-42.667c-11.797-.001-21.333 9.557-21.333 21.333s9.536 21.333 21.333 21.333h22.485l17.963 323.541c1.899 33.899 29.995 60.459 63.936 60.459h260.565c33.941 0 62.037-26.56 63.936-60.459l17.963-323.541h22.485c11.797 0 21.333-9.557 21.333-21.333s-9.535-21.334-21.332-21.334zm-309.59-17.728c3.691-14.677 16.811-24.939 31.957-24.939h85.931c15.147 0 28.267 10.261 31.957 24.939l4.416 17.728h-158.677zm10.923 337.728c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333zm85.333 0c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333zm85.334 0c0 11.776-9.536 21.333-21.333 21.333s-21.333-9.557-21.333-21.333v-213.333c0-11.776 9.536-21.333 21.333-21.333s21.333 9.557 21.333 21.333z"/></svg>
        </div>
        <!-- </button> -->
        <!-- <button v-show="!isInbox" @click.stop="onDeleteSent">Delete</button> -->
    </section>
`,
    data() {
        return {

        }
    },
    methods: {
        onDeleteMail() {
            mailService.deleteMail(this.mail.id);
        },
        onDeleteSent() {
            mailService.deleteSent(this.mail.id);
        },
        onStarClick() {
            // this.mail.isStarred = !this.mail.isStarred;
            mailService.starClick(this.mail.id);
        }

    },
    computed: {
        unread() {
            return { mailRead: this.mail.isRead, mailUnRead: !this.mail.isRead }
        },
        shortBody() {
            return `${this.mail.body.substring(0, 30)}...`;
        },
        convertSentTime() {
            return new Date(this.mail.sentAt).toLocaleDateString('he')
        },
        isStarred() {
            return { 'star-svg': this.mail.isStarred }
        }
    },
    created() {
    }
}